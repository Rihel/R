{"dependencies":[{"name":"/Users/rihel/Desktop/R/tsconfig.json","includedInParent":true,"mtime":1517672977000},{"name":"./util","loc":{"line":3,"column":21}}],"generated":{"js":"\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"./util\");\n// interface Tween{\n// \tfn(currentTime:number,beginVal:number,changeVal:number,duration:number):number;\n// }\nvar Core = /** @class */ (function () {\n    function Core(_a) {\n        var _b = _a.duration, duration = _b === void 0 ? 1000 : _b, render = _a.render, value = _a.value, _c = _a.timFn, timFn = _c === void 0 ? 'linear' : _c, onEnd = _a.onEnd;\n        this.startTime = 0;\n        this.state = 'init';\n        this.duration = duration;\n        this.values = value;\n        this.timFn = timFn;\n        this.render = render;\n        this.onEnd = onEnd;\n    }\n    Core.prototype._loop = function () {\n        var t = Date.now() - this.startTime;\n        var d = this.duration;\n        var timeFn = util_1.Util.Tween[this.timFn];\n        if (t >= d || this.state === 'end') {\n            this.end();\n        }\n        else {\n            this._renderFn(t, d, timeFn);\n            util_1.Util.reqAnimF(this._loop.bind(this));\n        }\n    };\n    Core.prototype.end = function () {\n        this._renderEndState();\n        this.onEnd && this.onEnd();\n    };\n    Core.prototype._renderEndState = function () {\n        var t = Date.now() - this.startTime;\n        var d = this.duration;\n        var timeFn = util_1.Util.Tween[this.timFn];\n        this._renderFn(d, d, timeFn);\n        this.state = 'end';\n    };\n    Core.prototype._renderFn = function (time, duration, timingFn) {\n        var values = this.values;\n        var doneVal = values.map(function (value) {\n            return timingFn(time, value.start, value.end - value.start, duration);\n        });\n        this.render.apply(this, doneVal);\n    };\n    Core.prototype._play = function () {\n        this.startTime = Date.now();\n        this.state = 'play';\n        util_1.Util.reqAnimF(this._loop.bind(this));\n    };\n    Core.prototype.play = function () {\n        this._play();\n    };\n    return Core;\n}());\nexports.default = Core;\n","map":{"version":3,"file":"core.js","sourceRoot":"","sources":["R/src/lib/core.ts"],"names":[],"mappings":";;AAAA,+BAAiC;AASjC,mBAAmB;AACnB,mFAAmF;AACnF,IAAI;AAEJ;IAQC,cAAY,EAML;YALN,gBAAa,EAAb,oCAAa,EACb,kBAAM,EACN,gBAAK,EACL,aAAc,EAAd,qCAAc,EACd,gBAAK;QAXE,cAAS,GAAQ,CAAC,CAAC;QAKpB,UAAK,GAAQ,MAAM,CAAC;QAQ1B,IAAI,CAAC,QAAQ,GAAC,QAAQ,CAAC;QACvB,IAAI,CAAC,MAAM,GAAC,KAAK,CAAC;QAClB,IAAI,CAAC,KAAK,GAAC,KAAK,CAAC;QACjB,IAAI,CAAC,MAAM,GAAC,MAAM,CAAC;QACnB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IAEpB,CAAC;IACO,oBAAK,GAAb;QACE,IAAM,CAAC,GAAQ,IAAI,CAAC,GAAG,EAAE,GAAC,IAAI,CAAC,SAAS,CAAC;QACzC,IAAM,CAAC,GAAU,IAAI,CAAC,QAAkB,CAAC;QACzC,IAAM,MAAM,GAAG,WAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAEtC,EAAE,CAAA,CAAC,CAAC,IAAE,CAAC,IAAI,IAAI,CAAC,KAAK,KAAG,KAAK,CAAC,CAAA,CAAC;YAC9B,IAAI,CAAC,GAAG,EAAE,CAAC;QACZ,CAAC;QAAA,IAAI,CAAA,CAAC;YACL,IAAI,CAAC,SAAS,CAAC,CAAC,EAAC,CAAC,EAAC,MAAM,CAAC,CAAC;YAC3B,WAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACtC,CAAC;IAEH,CAAC;IAEO,kBAAG,GAAX;QACC,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;IAC5B,CAAC;IAEO,8BAAe,GAAvB;QACC,IAAM,CAAC,GAAQ,IAAI,CAAC,GAAG,EAAE,GAAC,IAAI,CAAC,SAAS,CAAC;QACzC,IAAM,CAAC,GAAU,IAAI,CAAC,QAAkB,CAAC;QACzC,IAAM,MAAM,GAAG,WAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACtC,IAAI,CAAC,SAAS,CAAC,CAAC,EAAC,CAAC,EAAC,MAAM,CAAC,CAAC;QAC3B,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IACpB,CAAC;IAEO,wBAAS,GAAjB,UACC,IAAW,EACX,QAAe,EACf,QAIyB;QAGxB,IAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAC3B,IAAM,OAAO,GAAU,MAAM,CAAC,GAAG,CAAC,UAAA,KAAK;YACtC,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAC,KAAK,CAAC,KAAK,EAAC,KAAK,CAAC,GAAG,GAAC,KAAK,CAAC,KAAK,EAAC,QAAQ,CAAC,CAAC;QAClE,CAAC,CAAC,CAAA;QAEF,IAAI,CAAC,MAAM,OAAX,IAAI,EAAW,OAAO,EAAE;IAE1B,CAAC;IACO,oBAAK,GAAb;QACC,IAAI,CAAC,SAAS,GAAC,IAAI,CAAC,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,KAAK,GAAC,MAAM,CAAC;QAClB,WAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACtC,CAAC;IACD,mBAAI,GAAJ;QACC,IAAI,CAAC,KAAK,EAAE,CAAC;IACd,CAAC;IACF,WAAC;AAAD,CAAC,AA3ED,IA2EC","sourcesContent":["import {Util,Step} from \"./util\";\ninterface ICore{\n\tduration?:number;\n\trender(...args:number[]):void;\n\tvalue:Step[];\n\ttimFn?:string;\n\tonEnd?:()=>void;\n}\n\n// interface Tween{\n// \tfn(currentTime:number,beginVal:number,changeVal:number,duration:number):number;\n// }\n\nexport default class Core{\n\tprivate duration?:number;\n\tprivate startTime:number=0;\n\tprivate render:(...args:number[])=>void;\n\tprivate values:Step[];\n\tprivate timFn:string;\n\tprivate onEnd:()=>void;\n\tpublic state:string='init';\n\tconstructor({\n\t\tduration=1000,\n\t\trender,\n\t\tvalue,\n\t\ttimFn='linear',\n\t\tonEnd\n\t}:ICore){\n\t\tthis.duration=duration;\n\t\tthis.values=value;\t\n\t\tthis.timFn=timFn;\n\t\tthis.render=render;\n\t\tthis.onEnd = onEnd;\n\n\t}\n\tprivate _loop(){\n\t\t\tconst t:number=Date.now()-this.startTime;\n\t\t\tconst d:number = this.duration as number;\n\t\t\tconst timeFn = Util.Tween[this.timFn];\n\t\t\t\n\t\t\tif(t>=d\t|| this.state==='end'){\n\t\t\t\tthis.end();\n\t\t\t}else{\n\t\t\t\tthis._renderFn(t,d,timeFn);\n\t\t\t\tUtil.reqAnimF(this._loop.bind(this));\n\t\t\t}\n\n\t}\n\n\tprivate end(){\n\t\tthis._renderEndState();\n\t\tthis.onEnd && this.onEnd();\n\t}\n\n\tprivate _renderEndState(){\n\t\tconst t:number=Date.now()-this.startTime;\n\t\tconst d:number = this.duration as number;\n\t\tconst timeFn = Util.Tween[this.timFn];\n\t\tthis._renderFn(d,d,timeFn);\n\t\tthis.state = 'end';\n\t}\n\n\tprivate _renderFn(\n\t\ttime:number,\n\t\tduration:number,\n\t\ttimingFn:(\n\t\t\tcurrentTime:number,\n\t\t\tbeginVal:number,\n\t\t\tchangeVal:number,\n\t\t\tduration:number)=>number\n\t\t){\n\n\t\t\tconst values = this.values;\n\t\t\tconst doneVal:number[]=values.map(value=>{\n\t\t\t\treturn timingFn(time,value.start,value.end-value.start,duration);\n\t\t\t})\n\n\t\t\tthis.render(...doneVal);\n\t\t\n\t}\n\tprivate _play():void{\n\t\tthis.startTime=Date.now();\n\t\tthis.state='play';\n\t\tUtil.reqAnimF(this._loop.bind(this));\n\t}\n\tplay(){\n\t\tthis._play();\n\t}\n}"]}},"hash":"b43290ff305c492dccddda913d8b944a","cacheData":{"env":{}}}